# 首页随机推荐功能

## 功能概述

首页的"开始探索"按钮现在会动态调用随机接口获取一个真实的网站ID，而不是使用固定的ID，为用户提供更丰富的探索体验。

## 实现原理

### 1. 动态获取随机网站
- 页面加载时自动调用 `/api/random` 接口
- 获取一个随机的网站ID（abbrlink、slug或id）
- 将获取到的ID用于"开始探索"按钮的链接

### 2. 用户体验优化
- **加载状态**：在获取随机网站时显示"加载中..."
- **错误处理**：如果获取失败，使用默认的 `paper-planes` 作为备选
- **无缝体验**：用户点击按钮时直接跳转到随机网站

### 3. 技术实现
```javascript
// 获取随机网站ID
const fetchRandomSiteId = async () => {
  setIsLoading(true)
  try {
    const res = await fetch('/api/random', { headers: { accept: 'application/json' } })
    if (!res.ok) throw new Error('bad status')
    const data = await res.json()
    if (!data?.url) throw new Error('no url')
    
    const siteId = data.abbrlink || data.slug || data.id
    setRandomSiteId(siteId)
  } catch (error) {
    console.error('获取随机网站失败:', error)
    // 如果获取失败，使用默认的paper-planes
    setRandomSiteId('paper-planes')
  } finally {
    setIsLoading(false)
  }
}
```

## 功能特性

### 1. 真正的随机性
- 每次页面加载都会获取不同的随机网站
- 用户每次访问首页都能看到不同的推荐
- 增加网站的探索性和趣味性

### 2. 智能降级
- 如果随机接口失败，自动使用备选网站
- 确保用户始终能够正常使用功能
- 提供稳定的用户体验

### 3. 响应式设计
- 支持中英文界面
- 加载状态有相应的文字提示
- 按钮状态根据加载情况动态变化

## 用户体验流程

1. **页面加载**：用户访问首页
2. **自动获取**：系统自动调用随机接口
3. **显示状态**：按钮显示"加载中..."或"开始探索"
4. **点击跳转**：用户点击按钮跳转到随机网站
5. **探索体验**：用户开始探索推荐的网站

## 技术优势

### 1. 服务端渲染友好
- 不影响SSR性能
- 客户端动态获取数据
- 保持页面加载速度

### 2. 错误处理完善
- 网络错误处理
- API错误处理
- 降级策略

### 3. 状态管理清晰
- 使用React hooks管理状态
- 清晰的加载状态
- 优雅的错误处理

## 测试验证

### 1. 功能测试
- ✅ 页面加载时自动获取随机网站
- ✅ 按钮链接正确指向随机网站
- ✅ 加载状态正确显示
- ✅ 错误处理正常工作

### 2. 用户体验测试
- ✅ 每次刷新页面获取不同网站
- ✅ 加载时间合理
- ✅ 错误情况下有备选方案

### 3. 兼容性测试
- ✅ 中英文界面正常
- ✅ 响应式设计正常
- ✅ 不同浏览器兼容

## 未来优化

### 1. 可能的改进
- 添加网站预览信息
- 显示网站标题和描述
- 支持用户手动刷新推荐

### 2. 性能优化
- 缓存随机结果
- 预加载推荐网站
- 优化API调用频率

### 3. 用户体验
- 添加动画效果
- 显示推荐理由
- 支持收藏功能

## 总结

这个功能让首页的"开始探索"按钮变得更加智能和有趣，每次都能为用户推荐不同的网站，增加了网站的探索性和用户粘性。同时保持了良好的错误处理和用户体验。 